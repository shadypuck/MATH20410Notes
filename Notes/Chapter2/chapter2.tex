\documentclass[../notes.tex]{subfiles}

\pagestyle{main}
\renewcommand{\chaptermark}[1]{\markboth{\chaptername\ \thechapter\ (#1)}{}}
\stepcounter{chapter}

\begin{document}




\chapter{Differentiation}
\section{Notes}
\begin{itemize}
    \item \marginnote{1/10:}Since manifolds look like Euclidean spaces locally, we basically only need to study differentiation on Euclidean spaces.
    \item Set up: Let $U\subset\R^n$ be open, and $f:U\to\R^n$ be a function.
    \item Idea: The derivative of $f$ at some point $\vec{a}\in U$ is "the best linear approximation" to $f$ at $\vec{a}$.
    \item \textbf{Differentiable} (function $f$ at $\vec{a}$): A function $f$ for which there exists a linear transformation $A:\R^n\to\R^m$ such that
    \begin{equation*}
        \lim_{\vec{h}\to\bm{0}}\frac{f(\vec{a}+\vec{h})-f(\vec{a})-A\vec{h}}{\norm{\vec{h}}} = \bm{0}
    \end{equation*}
    \item \textbf{Total derivative} (of $f$ at $\vec{a}$): The linear transformation $A$ corresponding to a differentiable function $f$. \emph{Denoted by} $\bm{Df(\vec{a})}$.
    \item Questions to ask:
    \begin{enumerate}
        \item When does the total derivative exist?
        \item When it does exist, can there be multiple?
        \item When it exists and is unique, how do I calculate it?
    \end{enumerate}
    \item Proposition: If $A,B$ are linear transformations that both satisfy the definition, then $A=B$.
    \begin{itemize}
        \item We have
        \begin{align*}
            \lim_{\vec{h}\to\bm{0}}\frac{f(\vec{a}+\vec{h})-f(\vec{a})-A\vec{h}}{\norm{\vec{h}}} &= \bm{0}&
            \lim_{\vec{h}\to\bm{0}}\frac{f(\vec{a}+\vec{h})-f(\vec{a})-B\vec{h}}{\norm{\vec{h}}} &= \bm{0}
        \end{align*}
        \item It follows by subtracting the right equation above from the left one that
        \begin{equation*}
            \lim_{\vec{h}\to\bm{0}}\frac{A\vec{h}-B\vec{h}}{\norm{\vec{h}}} = \bm{0}
        \end{equation*}
        \item Apply linearity: For $\vec{v}\in\R^n$ and $t\in\R$, $t>0$, we have
        \begin{equation*}
            \frac{A(t\vec{v})-B(t\vec{v})}{t} = A\vec{v}-B\vec{v}
        \end{equation*}
        \item Therefore, since $t\vec{v}\to 0$ as $t\to 0$, we have by the above that
        \begin{align*}
            \bm{0} &= \lim_{t\to 0}\frac{A(t\vec{v})-B(t\vec{v})}{\norm{t\vec{v}}}\\
            &= \lim_{t\to 0}\frac{A\vec{v}-B\vec{v}}{\norm{\vec{v}}}\\
            \bm{0}\cdot\norm{\vec{v}} &= \lim_{t\to 0}(A\vec{v}-B\vec{v})\\
            \bm{0} &= A\vec{v}-B\vec{v}\\
            B\vec{v} &= A\vec{v}
        \end{align*}
    \end{itemize}
    \item Example: Let $f:\R^n\to\R^m$ be linear, i.e., $f(\vec{v})=A\vec{v}$ for some linear transformation $A$. Then for all $\vec{a}\in\R^n$, $Df(\vec{a})=A$ is constant.
    \begin{itemize}
        \item We have from the definition that
        \begin{align*}
            \lim_{\vec{h}\to\bm{0}}\frac{f(\vec{a}+\vec{h})-f(\vec{a})-A\vec{h}}{\norm{\vec{h}}} &= \lim_{\vec{h}\to\bm{0}}\frac{f(\vec{a})+f(\vec{h})-f(\vec{a})-f(\vec{h})}{\norm{\vec{h}}}\\
            &= \lim_{\vec{h}\to\bm{0}}\frac{\bm{0}}{\norm{\vec{h}}}\\
            &= \bm{0}
        \end{align*}
    \end{itemize}
    \item Theorem: If $f$ is differentiable at $\vec{a}$, then $f$ is continuous at $\vec{a}$.
    \begin{itemize}
        \item By definition, there exists a linear transformation $A$ such that
        \begin{equation*}
            \lim_{\vec{h}\to\bm{0}}\frac{f(\vec{a}+\vec{h})-f(\vec{a})-A\vec{h}}{\norm{\vec{h}}} = \bm{0}
        \end{equation*}
        \item Additionally, we have that
        \begin{equation*}
            f(\vec{a}+\vec{h}) = f(\vec{a})+A\vec{h}+\norm{\vec{h}}\left( \frac{f(\vec{a}+\vec{h})-f(\vec{a})-A\vec{h}}{\norm{\vec{h}}} \right)
        \end{equation*}
        \item As $\vec{h}\to\bm{0}$, the right-hand side of the above equation goes to $f(\vec{a})$.
        \begin{itemize}
            \item As a linear transformation, $A\vec{h}\to\bm{0}$ as $\vec{h}\to\bm{0}$.
            \item Clearly $\norm{\vec{h}}\to\bm{0}$ as $\vec{h}\to\bm{0}$.
            \item And we have by definition that the last term goes to $\bm{0}$ as $\vec{h}\to\bm{0}$.
        \end{itemize}
        \item Therefore, $f$ is continuous at $\vec{a}$.
    \end{itemize}
    \item Observation: A function $f:U\to\R^m$ is given by an $m$-tuple of functions $f_1:U\to\R$ known as components. $f=(f_1,\dots,f_m)$.
    \item Proposition: $f$ is differentiable at $\vec{a}\in U$ iff each component function $f_i$ is differentiable at $\vec{a}$. In this case,
    \begin{equation*}
        Df(\vec{a}) = (Df_1(\vec{a}),\dots,Df_m(\vec{a}))
    \end{equation*}
    \begin{itemize}
        \item We know that
        \begin{equation*}
            \lim_{\vec{h}\to\bm{0}}\frac{f(\vec{a}+\vec{h})-f(\vec{a})-A\vec{h}}{\norm{\vec{h}}} \in \R^m
        \end{equation*}
        \item Thus, the limit is zero iff the limit of each component is zero.
        \item We have that the $i^\text{th}$ component of the vector on the left below is equal to the number on the right; we call the common value $L_i(\vec{h})$.
        \begin{equation*}
            \left( \frac{f(\vec{a}+\vec{h})-f(\vec{a})-A\vec{h}}{\norm{\vec{h}}} \right)_i = \frac{f_i(\vec{a}+\vec{h})-f_i(\vec{a})-(A\vec{h})_i}{\norm{\vec{h}}}
        \end{equation*}
        \item The upshot is that $f$ is differentiable at $\vec{a}$ iff $\lim_{\vec{h}\to\bm{0}}L_i(\vec{h})=\bm{0}$ iff the linear transformation $\vec{h}\mapsto(A\vec{h})_i:\R^m\to\R$ is the total derivative of $f_i$.
    \end{itemize}
    \item Now, each $f_i$ is a function of $n$ variables, i.e., $f_i(x_1,\dots,x_n)$ where $x_1,\dots,x_n$ are coordinates on $\R^n$.
    \item \marginnote{1/12:}\textbf{Partial derivative} (of $f$ wrt. $x_i$ at $\vec{a}\in U$): The following quantity. \emph{Denoted by} $\bm{\partial f/\partial x_i}$. \emph{Given by}
    \begin{equation*}
        \pdv{f}{x_i}(\vec{a}) = \lim_{h\to 0}\frac{f(a_1,\dots,a_{i-1},a_i+h,a_{i+1},\dots,a_n)-f(\vec{a})}{h}
    \end{equation*}
    \begin{itemize}
        \item The partial derivative is easy to calculate if you're good at calculating single-variable derivatives.
    \end{itemize}
    \item Questions:
    \begin{enumerate}
        \item If the partial derivatives all exist, does the total derivative also exist?
        \item If partial derivatives exist, is $f$ continuous?
    \end{enumerate}
    \item The answer is no to both --- it's too weak a condition.
    \begin{itemize}
        \item Counter example: Consider $f:\R^2\to\R$ given by
        \begin{equation*}
            f(x,y) =
            \begin{cases}
                \frac{x^2y}{x^4+y^4} & (x,y)\neq\bm{0}\\
                0 & (x,y)=\bm{0}
            \end{cases}
        \end{equation*}
        \item All partial derivatives exist at $(0,0)$ but $f$ is not continuous at $(0,0)$.
        \item We'll consider this in the homework.
    \end{itemize}
    \item Now we try taking derivatives in infinitely many directions, as opposed to just $n$ many.
    \item \textbf{Directional derivative} (of $f$ at $\vec{a}$ in the direction of $\vec{v}\in\R^n$): The following quantity. \emph{Denoted by} $\bm{D_\vec{v}f(\vec{a})}$, $\bm{\partial f/\partial\vec{v}}$. \emph{Given by}
    \begin{equation*}
        D_\vec{v}f(\vec{a}) = \pdv{f}{\vec{v}} = \lim_{h\to 0}\frac{f(\vec{a}+h\vec{v})-f(\vec{a})}{h}
    \end{equation*}
    \begin{itemize}
        \item We always take $\norm{\vec{v}}=1$.
        \item The partial derivative is just a directional derivative along the standard basis vectors. Alternatively, the directional derivative is just a generalization of the partial derivatives.
    \end{itemize}
    \item This still isn't a strong enough condition --- the above counterexample has all directional derivatives at $(0,0)$ but still isn't continuous.
    \item Proposition: Suppose $f$ is differentiable at $\vec{a}\in U$. Then all directional derivatives of $f$ at $\vec{a}$ exist and for all $\vec{v}\in\R^n$,
    \begin{equation*}
        \pdv{f}{\vec{v}}(\vec{a}) = Df(\vec{a})(\vec{v})
    \end{equation*}
    \begin{itemize}
        \item The total derivative says that the derivative exists from all sequences of approach. We're just going to pick a particular vector direction of approach.
        \item Mathematically, by the definition of the total derivative,
        \begin{align*}
            \bm{0} &= \lim_{h\to 0}\frac{f(\vec{a}+h\vec{v})-f(\vec{a})-Df(\vec{a})(h\vec{v})}{h}\\
            &= \lim_{h\to 0}\frac{f(\vec{a}+h\vec{v})-f(\vec{a})}{h}-Df(\vec{a})(\vec{v})\\
            Df(\vec{a})(\vec{v}) &= \pdv{f}{\vec{v}}
        \end{align*}
    \end{itemize}
    \item A particular consequence is that
    \begin{equation*}
        \pdv{f}{x_i}(\vec{a}) = Df(\vec{a})(e_i)
    \end{equation*}
    \begin{itemize}
        \item But the total derivative, as a linear transformation, is completely defined by its behavior on the basis vectors.
        \item Thus, it is defined by the $m$-by-$n$ matrix
        \begin{equation*}
            Df(\vec{a}) = \left( \pdv{f_j}{x_i} \right)_{\substack{1\leq j\leq m\\1\leq i\leq n}}
        \end{equation*}
    \end{itemize}
    \item \textbf{Jacobian matrix} (of $f$ at $\vec{a}$): The above matrix, representing the total derivative of $f$ at $\vec{a}$.
    \item Theorem: Suppose $f:U\to\R^m$ is a function on an open set $U\subset\R^n$. If all partial derivatives of $f$ exist and are continuous on $U$, then $f$ is differentiable on $U$.
    \begin{itemize}
        \item Recall the mean value theorem (MVT): Suppose $g:[a,b]\to\R$ is a continuous function which is differentiable on $(a,b)$. Then there exists $c\in(a,b)$ such that $g'(c)=[g(b)-g(a)]/[b-a]$.
        \item WLOG let $m=1$ (if we prove this case, we can use the proposition relating $f$ to its components to prove the general case).
        \item Rewrite
        \begin{equation*}
            \begin{split}
                f(\vec{a}+\vec{h})-f(\vec{a}) ={}& f(a_1+h_1,a_2+h_2,a_3+h_3,\dots,a_n+h_n)-f(a_1,a_2+h_2,a_3+h_3,\dots,a_n+h_n)\\
                &+ f(a_1,a_2+h_2,a_3+h_3,\dots,a_n+h_n)-f(a_1,a_2,a_3+h_3,\dots,a_n+h_n)\\
                &+ \cdots\\
                &+ f(a_1,\dots,a_{n-1},a_n+h_n)-f(\vec{a})
            \end{split}
        \end{equation*}
        where $\vec{a}=(a_1,\dots,a_n)$ and $\vec{h}=(h_1,\dots,h_n)$.
        \item Apply the MVT to each term to get
        \begin{equation*}
            f(a_1,\dots,a_i+h_i,\dots,a_n+h_n)-f(a_1,\dots,a_i,\dots,a_n+h_n) = h_i{\pdv{f}{x_i}}(a_1,\dots,c_i(\vec{h}),\dots,a_n+h_n)
        \end{equation*}
        for some $c_i(\vec{h})\in(a_i,a_i+h_i)\cup(a_i+h_i,a_i)$.
        \item Now let $A$ be the Jacobian matrix of $f$ at $\vec{a}$.
        \item WTS:
        \begin{equation*}
            \lim_{\vec{h}\to\bm{0}}\frac{f(\vec{a}+\vec{h})-f(\vec{a})-A\vec{h}}{\norm{\vec{h}}} = \bm{0}
        \end{equation*}
        \item We have
        \begin{equation*}
            f(\vec{a}+\vec{h})-f(\vec{a}) = \sum_{i=1}^nh_i{\pdv{f}{x_i}}(a_1,\dots,c_i(\vec{h}),\dots,a_n+h_n)
        \end{equation*}
        \item Let $\pi_i:\R^n\to\R^n$ be the linear map $(x_1,\dots,x_n)\mapsto(0,\dots,x_i,\dots,0)$. Clearly, $\vec{x}=\sum_{i=1}^n\pi_i\vec{x}$.
        \item Thus, $A\vec{h}=\sum_{i=1}^nA\pi_i\vec{h}$ and $A\pi_i\vec{h}={\pdv{f}{x_i}}(\vec{a})\cdot h_i$.
        \item Applying, we have
        \begin{align*}
            \frac{f(\vec{a}+\vec{h})-f(\vec{a})-A\vec{h}}{\norm{\vec{h}}} &= \sum_{i=1}^n\frac{1}{\norm{\vec{h}}}\left( h_i{\pdv{f}{x_i}}(a_1,\dots,a_{i-1},c_i(\vec{h}),a_{i+1}+h_{i+1},\dots,a_n+h_n)-{\pdv{f}{x_i}}(\vec{a})\cdot h_i \right)\\
            &= \sum_{i=1}^n\frac{h_i}{\norm{\vec{h}}}\left( {\pdv{f}{x_i}}(a_1,\dots,a_{i-1},c_i(\vec{h}),a_{i+1}+h_{i+1},\dots,a_n+h_n)-{\pdv{f}{x_i}}(\vec{a}) \right)
        \end{align*}
        \item We know that $-1\leq h_i/\norm{\vec{h}}\leq 1$, so we need only show that the difference above goes to zero as $\vec{h}\to\bm{0}$. But we know this by the continuity of the partial derivatives.
    \end{itemize}
    \item Note that this theorem gives a sufficient condition but not a necessary condition for $f$ to be differentiable.
    \item \marginnote{1/14:}Theorem (Chain Rule): Suppose $f:U\to\R^m$ and $g:V\to\R^p$ are functions defined on open sets $U\subset\R^n$, $V\subset\R^m$ with $f(U)\subset V$. Suppose that $f$ is differentiable at $\vec{a}\in U$ and $g$ is differentiable at $\vec{b}=f(\vec{a})\in V$. Then the composite function $g\circ f:U\to\R^p$ is differentiable at $\vec{a}$ and $D(g\circ f)(\vec{a})=Dg(\vec{b})\circ Df(\vec{a}):\R^n\to\R^p$.
    \begin{itemize}
        \item Note that $f:U\to\R^m$ is differentiable at $\vec{a}\in U$ with derivative $A$ iff $f(\vec{a}+\vec{h})=f(\vec{a})+A\vec{h}+\tilde{f}(\vec{h})$ such that
        \begin{equation*}
            \lim_{\vec{h}\to\bm{0}}\frac{\tilde{f}(\vec{h})}{\norm{\vec{h}}} = \bm{0}
        \end{equation*}
        where $\tilde{f}$ is an error function.
        \begin{itemize}
            \item We're just rearranging terms here.
            \item If you like, $\tilde{f}$ is the numerator from the definition of the total derivative.
        \end{itemize}
        \item Let $A=Df(\vec{a})$, $B=Dg(\vec{b})$. Then
        \begin{equation*}
            f(\vec{a}+\vec{h}) = f(\vec{a})+A\vec{h}+\tilde{f}(\vec{h})
        \end{equation*}
        so
        \begin{align*}
            (g\circ f)(\vec{a}+\vec{h}) &= g(f(\vec{a}+\vec{h}))\\
            &= g(f(\vec{a}))+A\vec{h}+\tilde{f}(\vec{h})\\
            &= g(f(\vec{a}))+B(A\vec{h}+\tilde{f}(\vec{h}))+\tilde{g}(A\vec{h}+\tilde{f}(\vec{h}))\\
            &= g(f(\vec{a}))+BA\vec{h}+B\tilde{f}(\vec{h})+\tilde{g}(A\vec{h}+\tilde{f}(\vec{h}))
        \end{align*}
        \item WTS: $\lim_{\vec{h}\to\bm{0}}[B\tilde{f}(\vec{h})+\tilde{g}(A\vec{h}+\tilde{f}(\vec{h}))]/\norm{\vec{h}}=\bm{0}$.
        \item For the first half of the fraction,
        \begin{equation*}
            \frac{B\tilde{f}(\vec{h})}{\norm{\vec{h}}} = B\left( \frac{\tilde{f}(\vec{h})}{\norm{\vec{h}}} \right) \to \bm{0}
        \end{equation*}
        as $\vec{h}\to\bm{0}$ since the argument goes to $\bm{0}$ as $\vec{h}\to\bm{0}$ and $B$ is a linear transformation (in particular, $B(\vec{0})=\vec{0}$).
        \item For the second half of the fraction,
        \begin{equation*}
            \lim_{\vec{h}\to\bm{0}}\frac{\tilde{g}(A\vec{h}+\tilde{f}(\vec{h}))}{\norm{\vec{h}}} = \lim_{\vec{h}\to\bm{0}}\frac{\tilde{g}(A\vec{h}+\tilde{f}(\vec{h}))}{\norm{A\vec{h}+\tilde{f}(\vec{h})}}\cdot\frac{\norm{A\vec{h}+\tilde{f}(\vec{h})}}{\norm{\vec{h}}}
        \end{equation*}
        \begin{itemize}
            \item The left fraction on the right side of the equality goes to zero as $\vec{h}\to\bm{0}$ by the definition of $\tilde{g}$.
            \item The right fraction on the right side of the equality is bounded since
            \begin{equation*}
                \frac{\norm{A\vec{h}+\tilde{f}(\vec{h})}}{\norm{\vec{h}}} \leq \frac{\norm{A\vec{h}}}{\norm{\vec{h}}}+\frac{\norm{\tilde{f}(\vec{h})}}{\norm{\vec{h}}}
                \leq \norm{A}+\frac{\norm{\tilde{f}(\vec{h})}}{\norm{\vec{h}}}
            \end{equation*}
            where $\norm{A}$ is the operator norm and $\norm{\tilde{f}(\vec{h})}/\norm{\vec{h}}\to 0$ as $\vec{h}\to\bm{0}$ by the definition of $\tilde{f}$.
            \item Thus, the second half of the fraction goes to zero as well.
        \end{itemize}
    \end{itemize}
    \item Theorem: Let $U\subset\R^m$ be an open subset.
    \begin{enumerate}
        \item Suppose $f,g:U\to\R^m$ are functions that are differentiable at $\vec{a}\in U$. Then $f+g$ is also differentiable at $\vec{a}\in U$ and
        \begin{equation*}
            D(f+g)(\vec{a}) = Df(\vec{a})+Dg(\vec{a})
        \end{equation*}
        \item Suppose $f,g:U\to\R$ are both differentiable at $\vec{a}\in U$. Then $f\cdot g$ is also differentiable at $\vec{a}$, and
        \begin{equation*}
            D(f\cdot g)(\vec{a}) = Df(\vec{a})\cdot g(\vec{a})+f(\vec{a})\cdot Dg(\vec{a})
        \end{equation*}
        \item Suppose $f:U\to\R$ is differentiable at $\vec{a}\in U$ and $f(\vec{a})\neq 0$. Then $1/f$ is differentiable at $\vec{a}\in U$ and
        \begin{equation*}
            D(1/f)(\vec{a}) = -\frac{Df(\vec{a})}{f(\vec{a})^2}
        \end{equation*}
    \end{enumerate}
    \begin{itemize}
        \item Proof of 1: Consider the functions $F:U\to\R^{2m}$ and $G:\R^m\times\R^m\to\R^m$ defined by
        \begin{align*}
            F(\vec{x}) &= (f(\vec{x}),g(\vec{x}))&
            G(\vec{y},\vec{z}) &= \vec{y}+\vec{z}
        \end{align*}
        so that
        \begin{equation*}
            f+g = G\circ F
        \end{equation*}
        \begin{itemize}
            \item $F$ is differentiable because its components are differentiable.
            \item $G$ is differentiable because it's linear. This also implies that $DG(\vec{x})=G$.
            \item Apply the chain rule to learn that $G\circ F$ is differentiable with derivative
            \begin{align*}
                D(f+g)(\vec{a}) &= D(G\circ F)(\vec{a})\\
                &= DG(F(\vec{a}))\circ DF(\vec{a})\\
                &= G(DF(\vec{a}))\\
                &= G(Df(\vec{a}),Dg(\vec{a}))\\
                &= Df(\vec{a})+Dg(\vec{a})
            \end{align*}
        \end{itemize}
        \item Prove the others the same way.
    \end{itemize}
    \item Theorem (Mean Value Theorem): Suppose $f:U\to\R$ is differentiable for all $\vec{a}\in U$ and that $U$ contains the line segment joining $\vec{a},\vec{a}+\vec{h}\in U$. Then there exists $t_0\in(0,1)$ such that
    \begin{equation*}
        f(\vec{a}+\vec{h})-f(\vec{a}) = Df(\vec{a}+t_0\vec{h})(\vec{h})
    \end{equation*}
    \begin{itemize}
        \item Define $\phi(t)=f(\vec{a}+t\vec{h})$ for $t\in[0,1]$.
        \item Apply the usual MVT to $\phi$ to learn that there exists $t_0\in(0,1)$ such that $\phi(1)-\phi(0)=\phi'(t_0)$.
        \item Then using the chain rule, $\phi'(t_0)=Df(\vec{a}+t_0\vec{h})(\vec{h})$.
    \end{itemize}
    \item We now discuss higher order derivatives.
    \item \textbf{Differentiable} ($f$ on $U$): A function $f$ that is differentiable at every $\vec{a}\in U$.
    \item If $f$ is differentiable on $U$, then the total derivative gives a map $Df:U\to\lin{\R^n}{\R^m}$.
    \begin{itemize}
        \item Note that $\lin{\R^n}{\R^m}$ is isomorphic to the set of all $m$-by-$n$ matrices, and $\R^{mn}$.
    \end{itemize}
    \item We can ask for $Df$ to itself be differentiable. We define
    \begin{equation*}
        D^2f = D(Df)
    \end{equation*}
    if it exists and, more generally,
    \begin{equation*}
        D^kf = D(D^{k-1}f)
    \end{equation*}
    \item \textbf{Class $\bm{\mathcal{C}^k}$} (function): A function $f:U\to\R^m$ for which $Df,\dots,D^kf$ all exist and are continuous on $U$.
    \begin{itemize}
        \item Note that we technically need only require that $D^kf$ exist, as this implies the existence of $Df,\dots,D^{k-1}f$.
        \item A function $f:U\to\R^m$ is of class $\mathcal{C}^k$ iff all partial derivatives $\pdv*{f}{x_i}:U\to\R^m$ exist and are of class $\mathcal{C}^{k-1}$ (this follows from the theorem relating partial derivatives and differentiability).
    \end{itemize}
    \item \textbf{Smooth} (function): A function of class $\mathcal{C}^\infty$.
\end{itemize}




\end{document}